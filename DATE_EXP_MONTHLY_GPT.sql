
SET VER OFF


SET LINE 45
SET PAGES 20000
COLUMN EXP_VALUE FORMAT 99,99,999.99



TTITLE center 'Depot:'&&SC_CD', IV of Expired Medicine Month wise' SKIP2



SPOOL ON

SELECT DISTINCT LOC_CD,TO_CHAR(IV_DT, 'YYYY-MM') AS MONTH_YEAR, SUM(T_VAT*IV_QTY) AS EXP_VALUE
	FROM INV.FG_IV 
	WHERE LOC_CD='&&SC_CD'AND 
	TYP_CD='09' AND
  	IV_DT BETWEEN '01APR2024' AND '30APR2025' AND 
	DIV_CD IN('1','2') AND 
	IV_TYPE='47'
	GROUP BY LOC_CD,TO_CHAR(IV_DT, 'YYYY-MM')
	ORDER BY MONTH_YEAR;
 
SPOOL OFF

ED ON.LST







/* IF INPUT A PERIOD VALUE WILL BE DIFFERENT

LO MONTH_Y     EXP_VALUE
-- ------- -------------
31 2024-03   4,92,950.34
31 2024-04   3,70,364.24
31 2024-05   4,00,131.81
31 2024-06   3,37,186.78
31 2024-07   6,18,119.25
31 2024-08   5,95,002.07
31 2024-09   3,24,488.62
31 2024-10   7,92,068.72
31 2024-11   3,18,050.73
31 2024-12   7,52,666.63
31 2025-01   5,30,556.10
31 2025-02   3,35,815.87
31 2025-03   5,40,150.93

13 rows selected.


SQL> ED ZZ

SQL> @ZZ

Depot:SC_CD, RV of Expired Medicine Month wi

LO MONTH_Y     EXP_VALUE
-- ------- -------------
31 2025-03   4,79,919.72

*/